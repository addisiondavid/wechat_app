(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{19:function(e,t,a){"use strict";(function(e){a(5);n(a(3));var t=n(a(20));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=a,e(t.default)}).call(this,a(1)["createPage"])},20:function(e,t,a){"use strict";a.r(t);var n=a(21),i=a(23);for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a(28);var r,c=a(15),s=Object(c["default"])(i["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],r);s.options.__file="pages/index/index.vue",t["default"]=s.exports},21:function(e,t,a){"use strict";a.r(t);var n=a(22);a.d(t,"render",(function(){return n["render"]})),a.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),a.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),a.d(t,"components",(function(){return n["components"]}))},22:function(e,t,a){"use strict";var n;a.r(t),a.d(t,"render",(function(){return i})),a.d(t,"staticRenderFns",(function(){return r})),a.d(t,"recyclableRender",(function(){return o})),a.d(t,"components",(function(){return n}));try{n={uniNoticeBar:function(){return a.e("uni_modules/uni-notice-bar/components/uni-notice-bar/uni-notice-bar").then(a.bind(null,306))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var i=function(){var e=this,t=e.$createElement,a=(e._self._c,e.basic&&e.basic&&e.basic["TEM_Max_24h"]?parseInt(e.basic["TEM_Max_24h"]):null),n=e.basic&&e.basic&&e.basic["TEM_Min_24h"]?parseInt(e.basic["TEM_Min_24h"]):null;e.$mp.data=Object.assign({},{$root:{m0:a,m1:n}})},o=!1,r=[];i._withStripped=!0},23:function(e,t,a){"use strict";a.r(t);var n=a(24),i=a.n(n);for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},24:function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(a(25)),i=a(26);function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return u(e)||l(e)||s(e)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){if(e){if("string"===typeof e)return d(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?d(e,t):void 0}}function l(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function u(e){if(Array.isArray(e))return d(e)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var h=getApp().globalData,f={data:function(){return{basic:{},weatherName:"",levelColor:null,scrollHeight:0,BJDate:new Date,height:0,animationData:{},scrollTimer:null,newEarlyWarnData:"",subMenu:{actual:[{name:"降水",icon:"/static/images/shouye/ac-pre.png",ele:"PRE",path:"../actual/index"},{name:"气温",icon:"/static/images/shouye/ac-tem.png",ele:"TEM",path:"../actual/index"},{name:"风场",icon:"/static/images/shouye/ac-win.png",ele:"WIN",path:"../actual/index"},{name:"环境",icon:"/static/images/shouye/ac-air.png",ele:"AIR",path:"../actual/index"},{name:"雷达",icon:"/static/images/shouye/ac-radar.png",ele:"RADAR",path:"../actual/imgShow"},{name:"风四云图",icon:"/static/images/shouye/ac-satellite.png",ele:"SATELLITE",path:"../actual/imgShow"},{name:"灾情信息",icon:"/static/images/shouye/ac-disaster.png",ele:"DISASTER",path:"../actual/index"}],forecast:[{name:"降水",icon:"/static/images/shouye/for-pre.png",ele:"PRE",path:"../forecast/index"},{name:"气温",icon:"/static/images/shouye/for-tem.png",ele:"TEM",path:"../forecast/index"},{name:"风场",icon:"/static/images/shouye/for-win.png",ele:"WIN",path:"../forecast/index"},{name:"预警信号",icon:"/static/images/shouye/for-warn.png",ele:"WARN",path:"../forecast/index"}]},subMenuStyle:null,newProductList:[],aqiColorConf:{"优":"#1EF875","良":"#E4F33E","轻度污染":"#E4993E","中度污染":"#F10617","重度污染":"#99074E","严重污染":"#860022"}}},computed:{curid:function(){return this.$store.state._curid},thisTimeTransform:function(){return n.default}},watch:{curid:{handler:function(e){this.init()},immediate:!1,deep:!0}},onShow:function(){this.init()},methods:{init:function(){var t=this;e.showToast({title:"加载中",icon:"loading",duration:1e4}),this.getNearWarn(),setInterval((function(){t.getNearWarn()}),18e5),this.getNearForcest((function(a){console.log("data",a),e.hideToast(),t.basic=a[0],t.weatherName=(n.default.isDaylight()?(0,i.queryWeather2)(t.basic["WEP_Past_12hA"],"n"):(0,i.queryWeather2)(t.basic["WEP_Past_12h"],"d")).name,t.basic.img="/static/images/weather/".concat((n.default.isDaylight()?(0,i.queryWeather2)(t.basic["WEP_Past_12hA"],"n"):(0,i.queryWeather2)(t.basic["WEP_Past_12h"],"d")).image,".png"),t.basic.city=h.BASE_CONFIG.location.city,console.log("this.basic............................",t.basic)})),this.getAirqualityForecast((function(e){console.log(t.aqiColorConf[e["V_QUAL"]]),t.levelColor=t.aqiColorConf[e["V_QUAL"]]})),this.getNewProductList(),this.subMenuStyle="\n\t\t\t    width: ".concat((h.systemInfo.windowWidth-20)/4,"px;\n\t\t\t    height: ").concat((h.systemInfo.windowWidth-20)/4,"px \n\t\t\t");var a=h.BASE_CONFIG.location.curid;setTimeout((function(){console.info(a,h.BASE_CONFIG.location),a!=h.BASE_CONFIG.location.curid&&(console.info(h.BASE_CONFIG.location),t.getNearForcest((function(a){e.hideToast(),t.weatherName=(n.default.isDaylight()?(0,i.queryWeather2)(t.basic["WEP_Past_12hA"],"n"):(0,i.queryWeather2)(t.basic["WEP_Past_12h"],"d")).name,t.basic=a[0],t.basic.img="/static/images/weather/".concat((n.default.isDaylight()?(0,i.queryWeather2)(t.basic["WEP_Past_12h"],"n"):(0,i.queryWeather2)(t.basic["WEP_Past_12h"],"d")).image,".png"),t.basic.city=h.BASE_CONFIG.location.city})),t.getAirqualityForecast((function(e){console.log(t.aqiColorConf[e["V_QUAL"]]),t.levelColor=t.aqiColorConf[e["V_QUAL"]]})))}),2e3)},getNearWarn:function(){var t=this,a=new Date,i=(n.default.toTimeWorld(a),a.Format("yyyyMMddhhmmss")),o=n.default.getAppointHourStr(a,-2,"yyyyMMddhhmmss");e.request({url:"".concat(h.API.wx_api,"/queryUdi/getEleByTimeRange?dataCode=SEVP_NX_ALARM&interfaceId=getEleByTimeRange&timeRange=%5B").concat(o,",").concat(i,"%5D&elements=headline,Datetime"),header:{"Content-Type":"application/json"},data:{key:h._apiKey},dataType:"json",success:function(e){var a="";e&&e.data&&e.data.DS&&e.data.DS.length>0&&(e.data.DS.forEach((function(e){a+="".concat(n.default.toTimeZone(e.Datetime,-8,"dd日hh:mm"),"-").concat(e.headline,"  ")})),t.newEarlyWarnData=a)}})},getNearForcest:function(t){var a;console.log(t);var i=this.BJDate.getHours();a=i<8?n.default.getAppointDateStr(this.BJDate,-1,"yyyyMMdd120000"):i>=8&&i<20?n.default.getAppointDateStr(this.BJDate,0,"yyyyMMdd000000"):n.default.getAppointDateStr(this.BJDate,0,"yyyyMMdd120000"),e.request({url:"".concat(h.API.wx_api,"/queryUdi/getEleByTimeAndAreaCode?dataCode=SEVP_NX_WEFC_RFFC&interfaceId=getEleByTimeAndAreaCode&times=").concat(a,"&elements=Station_Name,TEM_Max_24h,TEM_Min_24h,WEP_Past_12h&areacode=")+h.BASE_CONFIG.location.curid.substr(0,6)+"&eleValueRanges=Validtime:24;Prod_Code:SPCC",header:{"Content-Type":"application/json"},dataType:"json",success:function(e){0==e.data.returnCode&&t(e.data.DS)}})},getAirqualityForecast:function(t){var a=new Date,i=n.default.toTimeWorld(a),o=i.Format("yyyyMMddhhmmss"),r=n.default.getAppointHourStr(i,-2,"yyyyMMddhhmmss");e.request({url:"".concat(h.API.wx_api,"/queryUdi/getEleByTimeRangeAndRadius?interfaceId=getEleByTimeRangeAndRadius&dataCode=CAWN_MEE_AIR_EMO&timeRange=%5B").concat(r,",").concat(o,"%5D&elements=Datetime,Station_Id_C,V_QUAL&distance=15000&orderBy=Datetime:desc"),header:{"Content-Type":"application/json"},data:{key:h._apiKey,lat:h.BASE_CONFIG.location.lat,lon:h.BASE_CONFIG.location.lon,an:h.BASE_CONFIG.location.curid.substr(0,4)},dataType:"json",success:function(e){if(e&&e.data&&e.data.DS&&e.data.DS.length>0)for(var a=0;a<e.data.DS.length;a++)if("999900"!=e.data.DS[a]["V_QUAL"]){t(e.data.DS[a]);break}}})},goWeather:function(){e.navigateTo({url:"../weather/index",fail:function(e){console.log(e)}})},getNewProductList:function(){var t=this;if(h._apiKey){var a=new Date,i=a.Format("yyyyMMddhhmmss"),o=n.default.getAppointDateStr(a,-30,"yyyyMMddhhmmss");e.request({url:"".concat(h.API.wx_api,"/downUdi/getFileByTimeRangeAndAreaCode?interfaceId=getFileByTimeRangeAndAreaCode&dataCode=SEVP_NX_DOC_FILE&timeRange=%5B").concat(o,",").concat(i,"%5D&elements=RETAIN1,File_URL,Datetime&orderBy=Datetime:desc&areaCode=NX"),header:{"Content-Type":"application/json"},data:{key:h._apiKey},dataType:"json",success:function(e){if(200==e.statusCode){var a,n=e.data.DS;t.newProductList=[],(a=t.newProductList).push.apply(a,r(n.slice(0,6)))}}})}},prizeScroll:function(t){var a=this;clearInterval(this.scrollTimer);var n=50;this.getHeight(t);var i=e.createAnimation({duration:this.height/n,timingFunction:"linear",delay:0});this.animation=i,this.scrollTimer=setInterval((function(){a.scrollHeight>=a.height?(i.translateY(0).step(),a.scrollHeight=0,a.animationData=i.export()):(a.scrollHeight=a.scrollHeight+1,i.translateY(-a.scrollHeight).step(),a.animationData=i.export())}),n)},getHeight:function(e){this.height=40*e-120},getToDetail:function(t){var a=h.API.wx_api+t.File_URL;e.showLoading({title:"正在加载文件...",mask:!0}),e.downloadFile({url:a,filePath:wx.env.USER_DATA_PATH+"/"+"".concat(t.RETAIN1,".pdf"),success:function(t){e.hideLoading();var a=t.filePath;e.openDocument({filePath:a,fileType:"pdf",showMenu:!0,success:function(e){console.log("打开文档成功")}})},fail:function(){e.hideLoading()}})},goProductTabView:function(){e.switchTab({url:"../product/index",fail:function(e){console.log(e)}})},getRouterView:function(t,a){console.log("menuItem:",a," dataType：",t),a.hasOwnProperty("ele")&&e.navigateTo({url:"".concat(a.path,"?dataType=").concat(t,"&ele=").concat(a.ele,"&eleName=").concat(a.name),fail:function(e){console.log(e)}})}}};t.default=f}).call(this,a(1)["default"])},28:function(e,t,a){"use strict";a.r(t);var n=a(29),i=a.n(n);for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},29:function(e,t,a){}},[[19,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/index/index.js.map
(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/actual/stationDetail"],{75:function(e,t,n){"use strict";(function(e){n(5);a(n(3));var t=a(n(76));function a(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n(1)["createPage"])},76:function(e,t,n){"use strict";n.r(t);var a=n(77),r=n(79);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n(81);var c,i=n(15),l=Object(i["default"])(r["default"],a["render"],a["staticRenderFns"],!1,null,null,null,!1,a["components"],c);l.options.__file="pages/actual/stationDetail.vue",t["default"]=l.exports},77:function(e,t,n){"use strict";n.r(t);var a=n(78);n.d(t,"render",(function(){return a["render"]})),n.d(t,"staticRenderFns",(function(){return a["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return a["recyclableRender"]})),n.d(t,"components",(function(){return a["components"]}))},78:function(e,t,n){"use strict";var a;n.r(t),n.d(t,"render",(function(){return r})),n.d(t,"staticRenderFns",(function(){return c})),n.d(t,"recyclableRender",(function(){return o})),n.d(t,"components",(function(){return a}));try{a={ecCanvas:function(){return Promise.all([n.e("common/vendor"),n.e("components/ec-canvas")]).then(n.bind(null,313))}}}catch(i){if(-1===i.message.indexOf("Cannot find module")||-1===i.message.indexOf(".vue"))throw i;console.error(i.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var e=this,t=e.$createElement;e._self._c},o=!1,c=[];r._withStripped=!0},79:function(e,t,n){"use strict";n.r(t);var a=n(80),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},80:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=l(n(36)),r=i(n(39)),o=l(n(25));function c(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function i(e){if(e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=a?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(n,r,o):n[r]=e[r]}return n.default=e,t&&t.set(e,n),n}function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,a,r,o,c){try{var i=e[o](c),l=i.value}catch(u){return void n(u)}i.done?t(l):Promise.resolve(l).then(a,r)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function c(e){u(o,a,r,c,i,"next",e)}function i(e){u(o,a,r,c,i,"throw",e)}c(void 0)}))}}var _=getApp().globalData,s={data:function(){return{ec:{disableTouch:!0,lazyLoad:!0},stat_id:-1,stat_title:"",curr_ele:"",curr_sub_ele:"",curr_ele_conf:null,eleName_conf:{PRE:{name:"降水",chartType:"bar",ac_ele:"PRE_1h",ac_datacode:"SURF_NX_MUL_HOR",fr_datacode:"SEVP_NX_WEFC_RFFC",fr_ele:"PRE_PRE_Fore",d7_ac_ele:["PRE_Time_0808"],d7_fr_ele:["PRE_24h"],chartYName:"︵\nm\nm\n︶\n量\n水\n降"},TEM:{name:"气温",chartType:"line",ac_ele:"TEM",fr_ele:"TEM",ac_datacode:"SURF_NX_MUL_HOR",fr_datacode:"SEVP_NX_WEFC_RFFC",d7_ac_ele:["TEM_Max","TEM_Min"],d7_fr_ele:["TEM_Max_24h","TEM_Min_24h"],chartYName:"︵\n℃\n︶\n度\n温"},WIN:{name:"风速",chartType:"line",ac_ele:"WIN_S_Max",fr_ele:"WIN_S",ac_datacode:"SURF_NX_MUL_HOR",fr_datacode:"SEVP_NX_WEFC_RFFC",d7_ac_ele:["WIN_S_Max"],d7_fr_ele:["WIN_S"],chartYName:"︵\ns\n.\nm\n︶\n速\n风"},V_QUAL:{name:"AQI",chartType:"bar",ac_ele:"V_QUAL",ac_datacode:"CAWN_MEE_AIR_EMO",chartYName:"\nI\nQ\nA"},PM2p5_Densty:{name:"PM2.5",chartType:"line",ac_ele:"PM2p5_Densty",ac_datacode:"CAWN_MEE_AIR_EMO",chartYName:"\n5\n.\n2\nM\nP"},PM10_Densty_Fore:{name:"PM10",chartType:"line",ac_ele:"PM10_Densty_Fore",ac_datacode:"CAWN_MEE_AIR_EMO",chartYName:"\n0\n1\nM\nP"}}}},onLoad:function(e){var t=e.Station_Id_C,n=e.V_CITY,a=e.ele,r=e.subEle;console.log("3:",a),console.log("4:",r),this.stat_id=t,this.stat_title=n,this.curr_ele=a,this.curr_sub_ele=r,this.curr_ele_conf=this.eleName_conf[this.curr_ele]||this.eleName_conf[this.curr_sub_ele]},onShow:function(){var t=this,n=e.createSelectorQuery().in(this);n.select(".temp-echart").boundingClientRect((function(e){t.get24hData(e)})).exec(),null!=this.curr_ele_conf.d7_ac_ele?n.select(".temp-d7-echart").boundingClientRect((function(e){t.get7dData(e)})).exec():n.select(".station-d7-box").hide()},methods:{get24hData:function(e){var t=this;return d(a.default.mark((function n(){var r,c,i,l,u,d,s;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("empty2?",t.curr_ele_conf),r=o.default.toTimeWorld(new Date),c=r.Format("yyyyMMddhhmmss"),i=o.default.getAppointHourStr(r,-24,"yyyyMMddhhmmss"),n.next=4,t.myRequest({url:"".concat(_.API.wx_api,"/queryUdi/getEleByTimeRangeAndStaIds?dataCode=").concat(t.curr_ele_conf.ac_datacode,"&interfaceId=getEleByTimeRangeAndStaIds&StaIds=").concat(t.stat_id,"&timeRange=%5B").concat(i,",").concat(c,"%5D&elements=Datetime,").concat(t.curr_ele_conf.ac_ele,"&orderBy=Datetime")});case 4:if(l=n.sent,null==t.curr_ele_conf.fr_datacode){n.next=13;break}return u=parseInt(r.Format("hh")),d=o.default.getAppointHourStr(r,0,"yyyyMMdd000000"),(u>20||0==u)&&(d=o.default.getAppointDateStr(r,-1,"yyyyMMdd120000")),n.next=11,t.myRequest({url:"".concat(_.API.wx_api,"/queryUdi/getEleByTimeAndStaIds?dataCode=").concat(t.curr_ele_conf.fr_datacode,"&interfaceId=getEleByTimeAndStaIds&times=").concat(d,"&StaIds=").concat(t.stat_id,"&elements=").concat(t.curr_ele_conf.fr_ele,",Validtime,Datetime&orderBy=Validtime&eleValueRanges=Prod_Code:SCMOC")});case 11:s=n.sent,t.init24hEchart([l.data.DS,s.data.DS],e.width,e.height);case 13:t.init24hEchart([l.data.DS,[]],e.width,e.height);case 14:case"end":return n.stop()}}),n)})))()},get7dData:function(e){var t=this;return d(a.default.mark((function n(){var r,c,i,l,u;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=o.default.toTimeWorld(new Date),r.Format("yyyyMMddhhmmss"),c=o.default.getAppointDateStr(r,-1,"yyyyMMdd235959"),i=o.default.getAppointDateStr(r,-8,"yyyyMMddhhmmss"),n.next=3,t.myRequest({url:"".concat(_.API.wx_api,"/queryUdi/getEleByTimeRangeAndStaIds?dataCode=SURF_NX_MUL_DAY&interfaceId=getEleByTimeRangeAndStaIds&StaIds=").concat(t.stat_id,"&timeRange=%5B").concat(i,",").concat(c,"%5D&elements=Datetime,Station_Id_C,").concat(t.curr_ele_conf.d7_ac_ele.join(","),"&orderBy=Datetime")});case 3:return l=n.sent,n.next=6,t.myRequest({url:"".concat(_.API.wx_api,"/queryUdi/getEleByTimeAndStaIds?dataCode=SEVP_NX_WEFC_RFFC&interfaceId=getEleByTimeAndStaIds&times=").concat(r.Format("yyyyMMdd000000"),"&StaIds=").concat(t.stat_id,"&elements=").concat(t.curr_ele_conf.d7_fr_ele.join(","),",Validtime,Datetime&orderBy=Validtime&eleValueRanges=Prod_Code:SCMOC")});case 6:u=n.sent,t.init7dEchart([l.data.DS,u.data.DS],e.width,e.height);case 8:case"end":return n.stop()}}),n)})))()},init24hEchart:function(e,t,n){var a=this,c=[],i=[];if(e[0].length>0&&e[0].forEach((function(e){c.push(o.default.toTimeZone(e.Datetime,0,"hh:mm")),999999==e[a.curr_ele_conf.ac_ele]?i.push(0):"优"==e[a.curr_ele_conf.ac_ele]?i.push({value:10,itemStyle:{color:"#1EF875"}}):"良"==e[a.curr_ele_conf.ac_ele]?i.push({value:10,itemStyle:{color:"#E4F33E"}}):"轻度污染"==e[a.curr_ele_conf.ac_ele]?i.push({value:10,itemStyle:{color:"#E4993E"}}):"中度污染"==e[a.curr_ele_conf.ac_ele]?i.push({value:10,itemStyle:{color:"#F10617"}}):"重度污染"==e[a.curr_ele_conf.ac_ele]?i.push({value:10,itemStyle:{color:"#99074E"}}):"严重污染"==e[a.curr_ele_conf.ac_ele]?i.push({value:10,itemStyle:{color:"#860022"}}):i.push(e[a.curr_ele_conf.ac_ele])})),e[1].length>0){var l=(parseInt((new Date).Format("hh"))-8)%3,u=e[1].slice(l,l+24);u.forEach((function(e){c.push(o.default.toTimeZone(e.Datetime,e.Validtime,"hh:mm")),i.push(999999==e[a.curr_ele_conf.fr_ele]?0:e[a.curr_ele_conf.fr_ele])}))}var d=Math.ceil(Math.max.apply(Math,i)),_=0,s=0;this.$refs["ec-canvas"].init((function(o){var l=r.init(o,null,{width:t,height:n}),u={grid:{top:10,left:10,right:5,bottom:10,containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:c,axisTick:{length:10},axisLabel:{fontSize:12,interval:2,rotate:45,color:"#7e7e7e"},axisLine:{onZero:!1}},{type:"category",data:[{value:"实况",textStyle:{fontSize:16,fontWeight:100,lineHeight:70,color:"#7e7e7e"}}],position:"top",axisTick:{show:!1},splitArea:{show:!0,areaStyle:{color:["#f4f9ff"]}},axisLine:{onZero:!1}}],yAxis:{type:"value",name:a.curr_ele_conf.chartYName,max:d+.1,nameTextStyle:{fontSize:12,nameLocation:"left",padding:[200,50,-170,0]},splitLine:{show:!1}},series:[{type:a.curr_ele_conf.chartType,data:i,barWidth:5,itemStyle:{normal:{color:"#96c97c"}},label:{show:!1,position:"top",textStyle:{color:"#000000"},formatter:function(e){var t=d<1?.1:1;return Math.abs(e.data-s)>t||e.dataIndex-_>2?(_=e.dataIndex,s=e.data,s):""}}}]};return e[1].length>0&&(u.xAxis[1].data.push({value:"预报",textStyle:{fontSize:16,fontWeight:100,lineHeight:70,color:"#7e7e7e"}}),u.xAxis[1].splitArea.areaStyle.color.push("#c5d9f2")),l.setOption(u),l}))},init7dEchart:function(e,t,n){var a=this,c=[],i=[],l=[];e[0].length>0&&e[0].forEach((function(e){c.push(o.default.toTimeZone(e.Datetime,0,"MM/dd"));var t=e[a.curr_ele_conf.d7_ac_ele[0]]>=5e5?0:e[a.curr_ele_conf.d7_ac_ele[0]];if(i.push(t),a.curr_ele_conf.d7_ac_ele[1]){var n=e[a.curr_ele_conf.d7_ac_ele[1]]>=5e5?0:e[a.curr_ele_conf.d7_ac_ele[1]];l.push(n)}})),e[1].length>0&&e[1].forEach((function(e){if(e.Validtime%24==0){c.push(o.default.toTimeZone(e.Datetime,e.Validtime,"MM/dd"));var t=e[a.curr_ele_conf.d7_fr_ele[0]]>=5e5?0:e[a.curr_ele_conf.d7_fr_ele[0]];if(i.push(t),a.curr_ele_conf.d7_fr_ele[1]){var n=e[a.curr_ele_conf.d7_fr_ele[1]]>=5e5?0:e[a.curr_ele_conf.d7_fr_ele[1]];l.push(n)}}})),this.$refs["ec-d7-canvas"].init((function(o){var u=r.init(o,null,{width:t,height:n});console.log(u);var d={grid:{top:10,left:10,right:5,bottom:10,containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:c,axisTick:{length:10},axisLabel:{fontSize:12,rotate:45,color:"#7e7e7e"},axisLine:{onZero:!1}},{type:"category",data:[{value:"实况",textStyle:{fontSize:16,fontWeight:100,lineHeight:70,color:"#7e7e7e"}}],position:"top",axisTick:{show:!1},splitArea:{show:!0,areaStyle:{color:["#f4f9ff"]}},axisLine:{onZero:!1}}],yAxis:{type:"value",name:a.curr_ele_conf.chartYName,nameTextStyle:{fontSize:12,nameLocation:"left",padding:[200,50,-160,0]},splitLine:{show:!1}},series:[{type:a.curr_ele_conf.chartType,data:i,barWidth:10,itemStyle:{normal:{color:"#f3c265"}},label:{show:!0,position:"top",textStyle:{color:"#000000"}}}]};return e[1].length>0&&(d.xAxis[1].data.push({value:"预报",textStyle:{fontSize:16,fontWeight:100,lineHeight:70,color:"#7e7e7e"}}),d.xAxis[1].splitArea.areaStyle.color.push("#c5d9f2")),a.curr_ele_conf.d7_ac_ele[1]&&d.series.push({type:a.curr_ele_conf.chartType,data:l,barWidth:10,itemStyle:{normal:{color:"#96c97c"}},label:{show:!0,position:"top",textStyle:{color:"#000000"}}}),u.setOption(d),u}))},myRequest:function(t){return new Promise((function(n,a){e.request({url:t.url,data:t.params||{},method:t.method||"GET",success:function(e){n(e)},fail:function(t){e.showToast({title:"网络错误，稍后重试！",icon:"error",duration:3e3}),a(null)}})}))}}};t.default=s}).call(this,n(1)["default"])},81:function(e,t,n){"use strict";n.r(t);var a=n(82),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},82:function(e,t,n){}},[[75,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/actual/stationDetail.js.map
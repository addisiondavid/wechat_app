(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/me/index"],{115:function(e,n,t){"use strict";(function(e){t(5);o(t(3));var n=o(t(116));function o(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=t,e(n.default)}).call(this,t(1)["createPage"])},116:function(e,n,t){"use strict";t.r(n);var o=t(117),a=t(119);for(var c in a)"default"!==c&&function(e){t.d(n,e,(function(){return a[e]}))}(c);t(280);var r,s=t(15),i=Object(s["default"])(a["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],r);i.options.__file="pages/me/index.vue",n["default"]=i.exports},117:function(e,n,t){"use strict";t.r(n);var o=t(118);t.d(n,"render",(function(){return o["render"]})),t.d(n,"staticRenderFns",(function(){return o["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return o["recyclableRender"]})),t.d(n,"components",(function(){return o["components"]}))},118:function(e,n,t){"use strict";var o;t.r(n),t.d(n,"render",(function(){return a})),t.d(n,"staticRenderFns",(function(){return r})),t.d(n,"recyclableRender",(function(){return c})),t.d(n,"components",(function(){return o}));var a=function(){var e=this,n=e.$createElement;e._self._c},c=!1,r=[];a._withStripped=!0},119:function(e,n,t){"use strict";t.r(n);var o=t(120),a=t.n(o);for(var c in o)"default"!==c&&function(e){t.d(n,e,(function(){return o[e]}))}(c);n["default"]=a.a},120:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=c(t(121)),a=t(279);function c(e){return e&&e.__esModule?e:{default:e}}var r=getApp().globalData,s={data:function(){return{hasUserInfo:!!e.getStorageSync("access_token"),jsCode:"",openid:"",session_key:"",userInfo:e.getStorageSync("user_info")||{avatarUrl:"/static/images/me/touxiang.png",nickName:""}}},computed:{version:function(){return r.BASE_CONFIG.version}},onLoad:function(n){e.getStorageSync("access_token")||this.doAuthorization()},methods:{doAuthorization:function(){var n=this;wx.login({success:function(t){t.code?(n.jsCode=t.code,console.log("获取code:",n.jsCode),e.request({url:"".concat(r.API.wx_api,"/wx_api/wxCheck"),method:"GET",data:{appid:r._appid,js_code:t.code,grant_type:"authorization_code"},success:function(e){n.openid=e.data.openid,n.session_key=e.data.session_key,console.log("获取openid:",n.openid)}})):e.showToast({title:"网络错误！",icon:"error",duration:3e3})}})},getPhoneNumber:function(n){if(console.info("qianyr",n),"getPhoneNumber:fail:access"==n.detail.errMsg)e.showModal({title:"用户未授权",content:"如需正常使用该小程序功能，请点击确定授权手机号！",showCancel:!1,success:function(e){e.confirm&&console.log("用户点击确定")}});else{var t=new o.default(r._appid,this.session_key),c=t.decryptData(n.detail.encryptedData,n.detail.iv);this.checkLoginStatus(a.Base64.encode(c.phoneNumber))}},checkLoginStatus:function(n){var t=this;e.request({url:"".concat(r.API.wx_api,"/wx_api/check"),method:"GET",data:{key:n},success:function(o){200==o.data.code?(t.loadUserInfo(),e.setStorageSync("access_token",n),r._apiKey=n,t.userInfo.nickName=o.data.data.user.nickname,e.setStorageSync("pro_class",o.data.data.article_type)):e.showModal({title:"非法用户",content:"此用户手机号非系统内用户，请联系管理员！",showCancel:!1,success:function(e){e.confirm&&console.log("用户点击确定")}})},fail:function(n){e.showToast({title:"网络错误！",icon:"error",duration:3e3})}})},loadUserInfo:function(){var n=this;e.getUserInfo({success:function(t){n.userInfo.avatarUrl=t.userInfo.avatarUrl,n.hasUserInfo=!0,e.setStorageSync("user_info",n.userInfo)},fail:function(n){e.clearStorageSync("access_token"),e.clearStorageSync("pro_class"),e.showToast({title:"获取用户失败",icon:"error",duration:3e3})}})},signOut:function(){e.clearStorageSync("access_token"),r._apiKey="",e.clearStorageSync("pro_class"),this.userInfo.avatarUrl="/static/images/me/touxiang.png",this.userInfo.nickName="",e.setStorageSync("user_info",this.userInfo),this.hasUserInfo=!1,e.reLaunch({url:"/pages/me/index"})},goto:function(n){e.navigateTo({url:n,fail:function(e){console.log(e)}})},jumpToAbout:function(){e.navigateTo({url:"/pages/me/aboutMe",fail:function(e){console.log(e)}})},jumpToContactUs:function(){e.navigateTo({url:"/pages/me/contactUs",fail:function(e){console.log(e)}})}}};n.default=s}).call(this,t(1)["default"])},280:function(e,n,t){"use strict";t.r(n);var o=t(281),a=t.n(o);for(var c in o)"default"!==c&&function(e){t.d(n,e,(function(){return o[e]}))}(c);n["default"]=a.a},281:function(e,n,t){}},[[115,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/me/index.js.map
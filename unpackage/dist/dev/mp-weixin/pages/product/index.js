(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/index"],{91:function(t,e,n){"use strict";(function(t){n(5);i(n(3));var e=i(n(92));function i(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n(1)["createPage"])},92:function(t,e,n){"use strict";n.r(e);var i=n(93),o=n(95);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);n(97);var r,a=n(15),c=Object(a["default"])(o["default"],i["render"],i["staticRenderFns"],!1,null,null,null,!1,i["components"],r);c.options.__file="pages/product/index.vue",e["default"]=c.exports},93:function(t,e,n){"use strict";n.r(e);var i=n(94);n.d(e,"render",(function(){return i["render"]})),n.d(e,"staticRenderFns",(function(){return i["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return i["recyclableRender"]})),n.d(e,"components",(function(){return i["components"]}))},94:function(t,e,n){"use strict";var i;n.r(e),n.d(e,"render",(function(){return o})),n.d(e,"staticRenderFns",(function(){return r})),n.d(e,"recyclableRender",(function(){return s})),n.d(e,"components",(function(){return i}));try{i={uniLoadMore:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-load-more/components/uni-load-more/uni-load-more")]).then(n.bind(null,332))},uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,352))}}}catch(a){if(-1===a.message.indexOf("Cannot find module")||-1===a.message.indexOf(".vue"))throw a;console.error(a.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.productList.length>0?t.__map(t.filterArt,(function(e,n){var i=t.__get_orig(e),o=t.thisTimeTransform.toTimeZone(e.Datetime,-8,"MM月dd日hh时");return{$orig:i,g0:o}})):null);t.$mp.data=Object.assign({},{$root:{l0:n}})},s=!1,r=[];o._withStripped=!0},95:function(t,e,n){"use strict";n.r(e);var i=n(96),o=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=o.a},96:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n(25));function o(t){return t&&t.__esModule?t:{default:t}}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=getApp().globalData,l={data:function(){return{productList:[],isRefreshing:!1,isInfiniting:!0,triggered:!0,infiniteDisabled:!1,loadMoreStatus:"noMore",topState:!1,scrollTop:0,oldScrollTop:0,classfiyData:[],bigClassData:[],subClassData:[],currentBigClassId:-1,curr_class_name:"气象信息专报",curr_class_id:void 0,isOpenClassfiyBox:!1,menuTypeConf:{},tagName:"",filterArt:[],carouselTxt:["天气","气候","农业","重大活动","大气污染","康养旅游","其他"],isActive:0}},computed:{thisTimeTransform:function(){return i.default}},onLoad:function(t){console.log("product page")},onShow:function(){this.getProductList(this.curr_class_id),this.initClassfiyData()},onTabItemTap:function(e){if(!c._apiKey)return t.showModal({title:"用户未登录",content:"如需正常使用该小程序功能，请前往登录！",showCancel:!0,success:function(e){e.confirm&&t.reLaunch({url:"/pages/me/index"})}}),!1},methods:{btn:function(t){var e=this,n=[];this.CAT="",this.isActive=t,this.filterArt=this.productList.filter((function(i){if("康养旅游"==e.carouselTxt[t]&&(e.CAT="康养旅游",i.RETAIN1.includes("康养")&&n.push(i),i.RETAIN1.includes("旅游")&&n.push(i)),"其他"!=e.carouselTxt[t])return i.RETAIN1.includes(e.carouselTxt[t]);0==i.RETAIN1.includes("天气")&&0==i.RETAIN1.includes("气候")&&0==i.RETAIN1.includes("农业")&&0==i.RETAIN1.includes("重大活动")&&0==i.RETAIN1.includes("大气污染")&&0==i.RETAIN1.includes("康养")&&0==i.RETAIN1.includes("旅游")&&(e.CAT="其他",n.push(i))})),"康养旅游"!=this.CAT&&"其他"!=this.CAT||(this.filterArt=n),console.log("this.filterArt",this.filterArt)},setData:function(t){var e,n,i=this,o=[];Object.keys(t).forEach((function(s){o=s.split("."),e=t[s],n=i.$data,o.forEach((function(t,s){s+1==o.length?i.$set(n,t,e):n[t]||i.$set(n,t,{}),n=n[t]}))}))},handleInput:function(t){var e=t.detail;this.tagName=e.value,this.filterArt=this.productList.filter((function(t){return t.RETAIN1.includes(e.value)})),console.log("this.filterArt",this.filterArt)},scroll:function(t){this.oldScrollTop=t.detail.scrollTop,t.detail.scrollTop>500?this.topState=!0:this.topState=!1},top:function(){var t=this;this.scrollTop=this.oldScrollTop,this.$nextTick((function(){t.scrollTop=0}))},initClassfiyData:function(){var e=this;this.classfiyData=t.getStorageSync("pro_class")||[],this.menuTypeConf={},this.classfiyData.map((function(t){e.menuTypeConf[t.id]=t.name})),this.classfiyData.unshift({id:"-1",pid:"0",name:"全部"},{id:"",pid:"-1",name:"全部"}),this.bigClassData=this.toTreeData(this.classfiyData),this.getSubClassDataByBigClass(this.bigClassData[0].id)},getSubClassDataByBigClass:function(t){var e=this;this.currentBigClassId=t,this.bigClassData.forEach((function(n){n.id==t&&(e.subClassData=n.children)})),console.log("this.subClassData:",this.subClassData)},toTreeData:function(t){var e={},n=[],i=0;while(0!=t.length){if(0==t[i].pid)n.push(r(r({},t[i]),{},{children:[]})),e[t[i].id]=[n.length-1],t.splice(i,1),i--;else{var o=e[t[i].pid];if(void 0!=o){for(var s=n[o[0]],a=1;a<o.length;a++)s=s.children[o[a]];s.children.push(r(r({},t[i]),{},{children:[]})),e[t[i].id]=o.concat([s.children.length-1]),t.splice(i,1),i--}}i++,i>t.length-1&&(i=0)}return n},toggleSubClassfiy:function(t){this.curr_class_name=t.name,this.curr_class_id=t.id,this.isOpenClassfiyBox=!1,this.getProductList(t.id)},getProductList:function(e){var n=this;if(c._apiKey){var o=new Date,s=o.Format("yyyyMMddhhmmss"),r=i.default.getAppointYearStr(o,-10,"yyyyMMddhhmmss"),a="".concat(c.API.wx_api,"/downUdi/getFileByTimeRange?interfaceId=getEleByTimeRange&dataCode=SEVP_NX_DOC_FILE&timeRange=%5B").concat(r,",").concat(s,"%5D&elements=ELE_CODE,RETAIN1,File_URL,Datetime&orderBy=Datetime:desc");e&&(a+="&eleValueRanges=ELE_CODE:".concat(e)),t.request({url:a,header:{"Content-Type":"application/json"},data:{key:c._apiKey},dataType:"json",success:function(t){200==t.statusCode&&(n.productList=t.data.DS,n.filterArt=n.productList,n.btn(0))}})}},goto:function(e){t.navigateTo({url:e,fail:function(t){console.log(t)}})},getToDetail:function(e){var n=c.API.wx_api+e.File_URL;t.showLoading({title:"正在加载文件...",mask:!0}),t.downloadFile({url:n,filePath:wx.env.USER_DATA_PATH+"/"+"".concat(e.RETAIN1,".pdf"),success:function(e){console.log("res::....",e),console.log("url:.....",n),t.hideLoading();var i=e.filePath;t.openDocument({filePath:i,fileType:"pdf",showMenu:!0,success:function(t){console.log("打开文档成功")}})},fail:function(e){t.hideLoading(),console.log("error:",error)}})},refresherNewList:function(){var t=this;this.isRefreshing||(this.isRefreshing=!0,this.triggered=!0,this.isInfiniting=!1,setTimeout((function(){t.refresherComplete()}),3e3))},refresherComplete:function(){this.triggered=!1,this.isRefreshing=!1,this.isInfiniting=!0,this.infiniteDisabled=!1},loadMoreList:function(){var t=this;this.isInfiniting&&(this.loadMoreStatus=this.infiniteDisabled?"noMore":"loading",setTimeout((function(){t.loadMoreStatus="noMore",t.infiniteDisabled=!1}),3e3))}}};e.default=l}).call(this,n(1)["default"])},97:function(t,e,n){"use strict";n.r(e);var i=n(98),o=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=o.a},98:function(t,e,n){}},[[91,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/product/index.js.map